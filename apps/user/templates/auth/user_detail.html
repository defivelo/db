{% extends "base.html" %}
{% load i18n %}
{% load bootstrap3 %}
{% load permission_tags %}

{% block head_title %}{{ userprofile.get_full_name }}{% endblock %}
{% block content %}
    <div class="panel panel-{{ userprofile.profile.status_class }} vcard">
        <div class="panel-heading">
            <h2 class="panel-title">
                <a href="{{ userprofile.get_absolute_url }}" class="fn">{{ userprofile.get_full_name }}</a>
                {% if userprofile.profile.formation or userprofile.profile.office_member %}
                    <span class="badge pull-right">{{ userprofile.profile.formation_full }} {{ userprofile.profile.formation_icon }}</span>
                {% endif %}
                {% if userprofile.profile.actor_for %}
                    <span class="badge pull-right">{{ userprofile.profile.actor_for }} {{ userprofile.profile.actor_icon }}</span>
                {% endif %}
                {% if userprofile.profile.can_login %}
                    <span class="badge pull-right">
                        <span class="glyphicon glyphicon-user" aria-hidden="true" title="{% trans "A accès" %}"></span>
                    </span>
                {% else %}
                    {% if request.user|can:"user_can_send_credentials" and request.user.pk != userprofile.pk %}
                        <a class="badge pull-right" href="{% url 'user-sendcredentials' pk=userprofile.pk %}" title="{% trans "Envoyer les données de connexion" %}">
                            <span class="glyphicon glyphicon-envelope" aria-hidden="true" title="{% trans "Envoyer les données de connexion" %}"></span>
                        </a>
                    {% endif %}
                {% endif %}
            </h2>
        </div>

        <div class="panel-body">
        {% comment %}
            <!-- Nav tabs -->
            <ul class="nav nav-tabs" role="tablist">
                <li role="presentation" class="active"><a href="#addr" aria-controls="coord" role="tab" data-toggle="tab">{% trans "Adresse" %}</a></li>
                <li role="presentation"><a href="#contacts" aria-controls="contacts" role="tab" data-toggle="tab">{% trans "Contacts" %}</a></li>
                {% if userprofile.profile.iban or userprofile.profile.social_security %}
                    <li role="presentation"><a href="#administrativia" aria-controls="administrativia" role="tab" data-toggle="tab">{% trans "Administratif" %}</a></li>
                {% endif %}
                <li role="presentation"><a href="#defi" aria-controls="defi" role="tab" data-toggle="tab">{% trans "Défi" %}</a></li>

                {% if userprofile.profile.comments %}
                    <li role="presentation"><a href="#notes" aria-controls="notes" role="tab" data-toggle="tab">{% trans "Notes" %}</a></li>
                {% endif %}
            </ul>
        {% endcomment %}

            <!-- Tab panes -->
            <div>
                <div role="tabpane" class="tab-pane active adr" id="addr">
                    <dl class="dl-horizontal">
                        <dt>{% trans "Nom" %}</dt>
                            <dd>{{ userprofile.get_full_name }}</dd>
                        <dt>{% trans "Adresse" %}</dt>
                            <dd>
                                <div class="street-address">{{ userprofile.profile.address_street }} {{ userprofile.profile.address_no }}</div>
                                <div>
                                    <span class="postal-code">{{ userprofile.profile.address_zip }}</span> <span class="locality">{{ userprofile.profile.address_city }}</span>
                                    {% if userprofile.profile.address_canton %}
                                    ({{ userprofile.profile.address_canton }})
                                    {% endif %}
                                </div>
                        </dd>
                    </dl>
                </div>
                <div role="tabpane" class="tab-pane" id="contacts">
                    <dl class="dl-horizontal">
                        {% if userprofile.profile.birthdate %}
                            <dt>{% trans "Date de naissance" %}</dt>
                                <dd>{{ userprofile.profile.birthdate|date }} ({% blocktrans with age=userprofile.profile.age %}{{ age }} ans{% endblocktrans %})</dd>
                        {% endif %}
                        {% if userprofile.email %}
                            <dt>{% trans "Email" %}</dt>
                                <dd><a class="email" href="mailto:{{ userprofile.mailtolink|urlencode }}">{{ userprofile.email }}</a></dd>
                        {% endif %}
                        {% if userprofile.profile.natel %}
                            <dt>{% trans "Natel" %}</dt>
                                <dd><a class="tel" href="tel:{{ userprofile.profile.natel_int }}">{{ userprofile.profile.natel }}</a></dd>
                        {% endif %}
                    </dl>
                </div>
                <div role="tabpane" class="tab-pane" id="administrativia">
                    <dl class="dl-horizontal">
                        {% if userprofile.profile.iban %}
                            <dt>{% trans "N° IBAN" %}</dt>
                                <dd><tt>{{ userprofile.profile.iban_nice }}</tt></dd>
                        {% endif %}
                        {% if userprofile.profile.social_security %}
                            <dt>{% trans "N° AVS" %}</dt>
                                <dd><tt>{{ userprofile.profile.social_security }}</tt></dd>
                        {% endif %}
                    </dl>
                </div>
                <div role="tabpane" class="tab-pane" id="defi">
                    <dl class="dl-horizontal">
                        {% if userprofile.profile.office_member %}
                            <dt>{% trans "Bureau Défi Vélo" %}</dt><dd><span class="glyphicon glyphicon-king"></span> {{ userprofile.profile.firstmed_course_comm }}</dd>
                        {% else %}
                            {% if userprofile.profile.formation %}
                                <dt>{% trans "Formation" %}</dt><dd>{{ userprofile.profile.formation_full }}</dd>
                            {% endif %}
                        {% endif %}
                        {% if userprofile.profile.actor %}
                            <dt>{% trans "Intervenant" %}</dt><dd>{{ userprofile.profile.actor_for.name }}</dd>
                        {% endif %}
                        {% if userprofile.profile.status > 0 %}
                        <dt>{% trans "État" %}</dt>
                            <dd class="text-{{ userprofile.profile.status_class }}">
                                    {{ userprofile.profile.status_icon }}
                                    {{ userprofile.profile.status_full }}
                                    {% if userprofile.profile.status_updatetime %}
                                        ({% trans "Dernière mise à jour: " %}{{ userprofile.profile.status_updatetime }})
                                    {% endif %}
                            </dd>
                        {% endif %}
                        {% if userprofile.profile.bagstatus > 0 %}
                            <dt>{% trans "Sac Défi Vélo" %}</dt>
                                <dd>
                                        {{ userprofile.profile.bagstatus_icon }}
                                        {{ userprofile.profile.bagstatus_full }}
                                        {% if userprofile.profile.bagstatus_updatetime %}
                                            ({% trans "Dernière mise à jour: " %}{{ userprofile.profile.status_updatetime }})
                                        {% endif %}
                                </dd>
                        {% endif %}
                        {% if userprofile.profile.pedagogical_experience %}
                            <dt>{% trans "Exp. pédagogique" %}</dt><dd>{{ userprofile.profile.pedagogical_experience }}</dd>
                        {% endif %}
                        <dt>{% trans "Cours samaritain" %}</dt><dd><span class="glyphicon glyphicon-{% if userprofile.profile.firstmed_course %}check{% else %}unchecked{% endif %}"></span> {{ userprofile.profile.firstmed_course_comm }}</dd>
                    </dl>
                </div>
                    <div role="tabpane" class="tab-pane" id="cantons">
                        <dl class="dl-horizontal">
                        {% if userprofile.profile.affiliation_canton %}
                            <dt>{% trans "Canton d'affiliation" %}</dt>
                            <dd>{{ userprofile.profile.affiliation_canton_verb }}</dd>
                        {% endif %}
                        {% if userprofile.profile.activity_cantons %}
                            <dt>{% trans "Défi Vélo Mobile" %}</dt>
                            <dd>{{ userprofile.profile.activity_cantons_verb|join:"<br />" }}
                            </dd>
                        {% endif %}
                        </dl>
                    </div>
                {% if request.user|can:'user_crud_dv_private_fields' and userprofile.profile.comments %}
                    <div role="tabpane" class="tab-pane" id="notes">
                       {{ userprofile.profile.comments }}
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
    {% buttons %}
    <div class="hidden-print">
        <a class="btn btn-primary pull-right" href="{% url 'user-update' pk=userprofile.pk %}">
            <span class="glyphicon glyphicon-pencil" aria-hidden="true" title="{% trans "Éditer" %}"></span>
            {% trans "Éditer" %}
        </a>
        {% if request.user|can:'user_view_list' %}
            <a class="btn btn-default" href="{% url 'user-list' %}">{% trans "Retour à la liste des utilisateurs" %}</a>
        {% endif %}
    {% endbuttons %}
    {% buttons %}
        {% if request.user|can:"user_create" %}
            <br />
            <a class="btn btn-primary pull-right" href="{% url 'user-create' %}">
                <span class="glyphicon glyphicon-user" aria-hidden="true"></span>
                {% trans "Nouvel utilisateur" %}
            </a>
        {% endif %}
    </div>
    {% endbuttons %}
{% endblock %}