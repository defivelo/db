---
- hosts: all
  vars_files:
   - parameters.yml
  become: no

  roles:
    ## Install some base packages and configuration files, this should be ok for all projects
    - { role: base }
    - { role: git }

    ## Database, choose either mysql or postgres, some subsequent roles will be configured
    ## depending on your choice here.
    - { role: postgresql }

    ## Scripting / Language support
    - { role: django }        # Django framework

    ## Webserver, choose one of those only if you have not choosed a scripting language
    ## above
    - { role: apache }         # Apache for basic HTML website

  tasks:
    - name: Allow password-less connection to the postgres user (mimics Travis-CI)
      template: src=pg_hba.conf.j2 dest=/etc/postgresql/9.4/main/pg_hba.conf
      become: yes
    - name: ensure postgresql is restarted
      action: service name=postgresql state=restarted
      become: yes